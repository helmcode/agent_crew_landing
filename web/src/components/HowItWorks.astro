---
import { useTranslations } from '../i18n/utils';
import type { Lang } from '../i18n/ui';

interface Props { lang?: Lang; }
const lang = Astro.props.lang ?? 'en';
const t = useTranslations(lang);

const steps = [
  {
    number: '01',
    title: t('howItWorks.s1Title'),
    description: t('howItWorks.s1Desc'),
    icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><line x1="19" y1="8" x2="19" y2="14"/><line x1="22" y1="11" x2="16" y2="11"/></svg>`,
  },
  {
    number: '02',
    title: t('howItWorks.s2Title'),
    description: t('howItWorks.s2Desc'),
    icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>`,
  },
  {
    number: '03',
    title: t('howItWorks.s3Title'),
    description: t('howItWorks.s3Desc'),
    icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg>`,
  },
  {
    number: '04',
    title: t('howItWorks.s4Title'),
    description: t('howItWorks.s4Desc'),
    icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>`,
  },
];
---

<section id="how-it-works" class="py-24 sm:py-32" style="background-color: #0a0f1e;">
  <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Header -->
    <div class="text-center mb-16">
      <span class="text-xs font-semibold tracking-widest uppercase text-blue-400 mb-4 block">{t('howItWorks.label')}</span>
      <h2 class="text-3xl sm:text-4xl lg:text-5xl font-bold text-white mb-4">
        {t('howItWorks.heading')} <span class="gradient-text">{t('howItWorks.headingGradient')}</span>
      </h2>
      <p class="text-lg text-slate-400 max-w-2xl mx-auto">
        {t('howItWorks.subtitle')}
      </p>
    </div>

    <!-- Steps -->
    <div class="relative">
      <!-- Connecting line (desktop) -->
      <div class="hidden lg:block absolute top-12 left-0 right-0 h-px" style="background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.3), rgba(139, 92, 246, 0.3), transparent); margin: 0 12%;"></div>

      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
        {steps.map((step, index) => (
          <div class="relative flex flex-col items-center text-center group">
            <!-- Step number circle -->
            <div class="relative z-10 w-24 h-24 rounded-2xl flex flex-col items-center justify-center mb-6 transition-all duration-300 group-hover:scale-105" style="background: linear-gradient(135deg, rgba(59, 130, 246, 0.15), rgba(139, 92, 246, 0.1)); border: 1px solid rgba(59, 130, 246, 0.3);">
              <div style="color: #60a5fa; margin-bottom: 4px;">
                <Fragment set:html={step.icon} />
              </div>
              <span class="text-xs font-bold text-blue-400/70">{step.number}</span>
            </div>

            <!-- Content -->
            <h3 class="text-white font-bold text-lg mb-3">{step.title}</h3>
            <p class="text-slate-400 text-sm leading-relaxed max-w-xs">{step.description}</p>

            <!-- Connector arrow (mobile/tablet) -->
            {index < steps.length - 1 && (
              <div class="lg:hidden mt-6 text-slate-600">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                  <path d="M12 5v14M5 12l7 7 7-7"/>
                </svg>
              </div>
            )}
          </div>
        ))}
      </div>
    </div>

    <!-- Install command mockup -->
    <div class="mt-20 rounded-2xl border border-slate-800 overflow-hidden" style="background-color: #0d1117;">
      <!-- Terminal title bar -->
      <div class="flex items-center gap-2 px-4 py-3 border-b border-slate-800" style="background-color: #161b22;">
        <div class="flex gap-1.5">
          <div class="w-3 h-3 rounded-full bg-red-500/70"></div>
          <div class="w-3 h-3 rounded-full bg-yellow-500/70"></div>
          <div class="w-3 h-3 rounded-full bg-green-500/70"></div>
        </div>
        <span class="text-slate-500 text-xs ml-2 font-mono">terminal</span>
      </div>
      <!-- Terminal content -->
      <div class="p-6 font-mono text-sm space-y-2">
        <div><span class="text-green-400">$</span> <span class="text-slate-300">curl -fsSL https://agentcrew.helmcode.com/install.sh | bash</span></div>
        <div class="text-blue-400">  Checking dependencies...</div>
        <div class="text-green-400">  [OK] Docker found</div>
        <div class="text-green-400">  [OK] Docker Compose found</div>
        <div class="text-blue-400">  Pulling images and starting AgentCrew...</div>
        <div class="text-slate-500">  [+] Running 4/4</div>
        <div class="text-slate-500">   ✔ Network agentcrew_default  Created</div>
        <div class="text-slate-500">   ✔ Container agentcrew-nats    Started</div>
        <div class="text-slate-500">   ✔ Container agentcrew-api     Started</div>
        <div class="text-slate-500">   ✔ Container agentcrew-web     Started</div>
        <div class="text-green-400">  [OK] All services are running</div>
        <div class="mt-2 text-green-400 font-bold">  ── AgentCrew is running! ──</div>
        <div class="mt-1"><span class="text-slate-400">  Open:</span> <span class="text-blue-400">http://localhost:8080</span></div>
      </div>
    </div>
  </div>
</section>
